<aside
  [ngClass]="{
    'flex flex-col bg-[#06a606] items-center transition-all duration-300 ease-in-out font-bold': true,
    'w-[60px]  h-full': isCollapsed,
    'w-[250px] md:w-[270px] h-full p-2': !isCollapsed,
    'fixed md:static z-50  ': !isCollapsed
  }"
>
  <!-- Botón toggle -->
  <div
    [ngClass]="{
      'flex mt-2': isCollapsed,
      'flex ': !isCollapsed
    }"
    class="h-[6%]"
  >
    <button
      (click)="toggleSidebar()"
      mat-icon-button
      class="w-[40px] h-[40px] flex text-xl bg-white rounded-full shadow-md"
    >
      <mat-icon *ngIf="isCollapsed">keyboard_arrow_right</mat-icon>
      <mat-icon *ngIf="!isCollapsed">close</mat-icon>
    </button>
  </div>

  <!-- Logo -->
  <div
    [ngClass]="{
      hidden: isCollapsed,
      'flex h-[20%] md:h-[25%] w-full justify-center items-center mt-5 md:mt-0 transition-all duration-300 ease-in-out':
        !isCollapsed
    }"
  >
    <img
      src="../../../../assets/images/Logo Samawe.png"
      alt="Logo Samawé"
      [ngClass]="{
        'h-[120px] md:h-[150px] w-[120px] md:w-[150px] rounded-full transition-all duration-300 ease-in-out':
          !isCollapsed
      }"
    />
  </div>

  <!-- Menú -->
  <nav class="w-full h-full px-2 overflow-y-auto">
    <div class="mt-[10px] md:mt-0">
      <ul class="flex flex-col transition-all duration-300 ease-in-out">
        <ng-container *ngFor="let module of menuWithItems">
          <div
            [ngClass]="{
              'flex  justify-start py-[6px]': !isCollapsed,
              'flex  justify-center py-[5px] mb-2': isCollapsed
            }"
          >
            <button
              [ngClass]="{
                'transition-all duration-300 ease-in-out flex items-center': true,
                ' ': !isCollapsed,
                'text-black': isCollapsed
              }"
            >
              <mat-icon
                [ngClass]="{
                  '  mx-[5px]': !isCollapsed,
                  'text-black': isCollapsed,
                  inline: true
                }"
              >
                {{ module.icon }}
              </mat-icon>
              <span *ngIf="!isCollapsed">{{ module.module }}</span>
            </button>
          </div>

          <ng-container *ngFor="let item of module.items">
            <li>
              <div
                [ngClass]="{
                  'flex  justify-start py-[3px] ': !isCollapsed,
                  'flex  justify-center py-[5px]': isCollapsed
                }"
              >
                <button
                  [matTooltip]="item.name"
                  [ngClass]="{
                    'transition-all duration-300 ease-in-out bg-none':
                      isCollapsed,
                    'flex w-full rounded-lg bg-white border border-black py-[5px] my-[3px]':
                      !isCollapsed,
                  }"
                  [routerLink]="
                    !item?.subItems?.length && item.route ? item?.route : null
                  "
                  (click)="!isCollapsed ? toggleSubMenu(item) : null"
                  [matMenuTriggerFor]="
                    isCollapsed && item?.subItems?.length ? submenu : null
                  "
                  #menuTrigger="matMenuTrigger"
                >
                  <mat-icon
                    [ngClass]="{
                      'mx-[5px]': !isCollapsed,
                      'text-[#06a606]': !isCollapsed,
                      'text-white': isCollapsed,
                      inline: true
                    }"
                  >
                    {{ item.icon }}
                  </mat-icon>
                  <span *ngIf="!isCollapsed">{{ item.name }}</span>
                </button>
              </div>

              <!-- Submenú -->
              <mat-menu #submenu="matMenu" yPosition="above">
                <ng-container *ngFor="let subItem of item.subItems">
                  <button mat-menu-item [routerLink]="subItem.route">
                    {{ subItem.name }}
                  </button>
                </ng-container>
              </mat-menu>

              <!-- Submenú extendido -->
              <div
                *ngIf="item.subItems?.length"
                [@submenuState]="openSubMenu[item.name] ? 'open' : 'closed'"
                [ngClass]="{
                  'transition-all duration-300 ease-in-out overflow-hidden': true,
                  'max-h-0 opacity-0': !openSubMenu[item.name],
                  'max-h-[500px] opacity-100': openSubMenu[item.name]
                }"
              >
                <ul class="pl-5 mt-1">
                  <li *ngFor="let subItem of item.subItems" class="my-1">
                    <a
                      role="button"
                      class="flex items-center gap-x-2 text-black bg-white rounded-lg border border-black px-3 py-[3px]"
                    >
                      <mat-icon class="text-[#your-color]">
                        {{ subItem.icon }}
                      </mat-icon>
                      <span [routerLink]="subItem.route">{{
                        subItem.name
                      }}</span>
                    </a>
                  </li>
                </ul>
              </div>
            </li>
          </ng-container>
        </ng-container>
      </ul>
    </div>
  </nav>

  <!-- Footer -->
  <div
    class="flex flex-col justify-end h-[10%] w-full items-center text-left gap-y-2"
  >
    <button
      (click)="logout.emit()"
      class=""
      [ngClass]="{
          'flex items-center justify-between w-full px-[10px] py-[5px] border border-black rounded-lg font-extrabold bg-white hover:bg-blue-400 gap-x-2': !isCollapsed,
          '': isCollapsed,
        }"
    >
      <mat-icon
        [ngClass]="{
          '  mx-[5px]': !isCollapsed,
          'text-black': isCollapsed,
          inline: true
        }"
        >exit_to_app</mat-icon
      >
      <span
        [ngClass]="{
          ' flex': !isCollapsed,
          'hidden': isCollapsed,
        }"
        >Cerrar Sesión</span
      >
    </button>
    <span
      class="text-white text-xs"
      [ngClass]="{
          ' flex': !isCollapsed,
          'hidden': isCollapsed,
        }"
      >© {{ currentYear }} Ecohotel Samawé.</span
    >
  </div>
</aside>
